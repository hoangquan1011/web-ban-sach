<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>L·ªãch s·ª≠ mua h√†ng - Nh√† S√°ch Online</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 0;
    }

    h2 {
      text-align: center;
      margin: 20px 0;
      color: #333;
    }

    table {
      width: 80%;
      margin: 0 auto;
      border-collapse: collapse;
      background-color: white;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
    }

    th, td {
      border: 1px solid #ddd;
      padding: 12px;
      text-align: center;
    }

    th {
      background-color: #4CAF50;
      color: white;
    }

    .nut-xem {
      background-color: #e74c3c;
      color: white;
      border: none;
      padding: 8px 14px;
      border-radius: 5px;
      cursor: pointer;
    }

    .nut-xem:hover {
      background-color: #c0392b;
    }

    .trang-thai {
      color: white;
      background-color: #27ae60;
      padding: 6px 10px;
      border-radius: 5px;
    }

    .container {
      width: 80%;
      margin: 30px auto;
      background: white;
      padding: 20px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      border-radius: 8px;
    }

    .quay-lai {
      display: inline-block;
      margin-top: 20px;
      background-color: #3498db;
      color: white;
      padding: 10px 16px;
      text-decoration: none;
      border-radius: 5px;
      cursor: pointer;
    }

    .quay-lai:hover {
      background-color: #2980b9;
    }

    .thongtin {
      margin-top: 10px;
      font-size: 16px;
      color: #444;
    }

    #chiTietDonHang {
      display: none;
    }

    .khong-co {
      text-align: center;
      font-style: italic;
      color: #777;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <!-- üîπ Ph·∫ßn danh s√°ch ƒë∆°n h√†ng -->
  <div id="lichSu">
    <h2>L·ªãch s·ª≠ mua h√†ng</h2>
    <table id="bangDonHang">
      <thead>
        <tr>
          <th>M√£ ƒë∆°n h√†ng</th>
          <th>Ng√†y mua</th>
          <th>Tr·∫°ng th√°i</th>
          <th>T·ªïng ti·ªÅn</th>
          <th>Chi ti·∫øt</th>
        </tr>
      </thead>
      <tbody id="danhSachDonHang"></tbody>
    </table>
    <p id="khongCo" class="khong-co">B·∫°n ch∆∞a c√≥ ƒë∆°n h√†ng n√†o.</p>
  </div>

  <!-- üîπ Ph·∫ßn chi ti·∫øt ƒë∆°n h√†ng -->
  <div id="chiTietDonHang" class="container">
    <h2>Chi ti·∫øt ƒë∆°n h√†ng</h2>
    <div id="thongTinDon"></div>
    <table id="bangSanPham">
      <thead>
        <tr>
          <th>T√™n s√°ch</th>
          <th>S·ªë l∆∞·ª£ng</th>
          <th>Gi√°</th>
        </tr>
      </thead>
      <tbody id="danhSachSanPham"></tbody>
    </table>
    <button class="quay-lai" onclick="quayLai()">‚Üê Quay l·∫°i l·ªãch s·ª≠ mua h√†ng</button>
  </div>

  <script>
    // ‚öôÔ∏è B∆Ø·ªöC 1: L·∫•y d·ªØ li·ªáu th·∫≠t t·ª´ localStorage (ho·∫∑c API)
    // N·∫øu b·∫°n c√≥ l∆∞u danh s√°ch ƒë∆°n h√†ng sau khi kh√°ch mua, v√≠ d·ª•:
    // localStorage.setItem("lichSuDonHang", JSON.stringify(donHangArray));
    // th√¨ ·ªü ƒë√¢y ch·ªâ c·∫ßn:
    const danhSachDon = JSON.parse(localStorage.getItem("lichSuDonHang")) || [];

    const bang = document.getElementById("danhSachDonHang");
    const lichSu = document.getElementById("lichSu");
    const chiTiet = document.getElementById("chiTietDonHang");
    const khongCo = document.getElementById("khongCo");

    // ‚öôÔ∏è B∆Ø·ªöC 2: Hi·ªÉn th·ªã danh s√°ch ƒë∆°n h√†ng
    function hienThiDanhSach() {
      bang.innerHTML = "";

      if (danhSachDon.length === 0) {
        khongCo.style.display = "block";
        return;
      }

      khongCo.style.display = "none";

      danhSachDon.forEach(don => {
        const dong = document.createElement("tr");
        dong.innerHTML = `
          <td>${don.maDon}</td>
          <td>${don.ngayMua}</td>
          <td><span class="trang-thai">${don.trangThai}</span></td>
          <td>${don.tongTien}</td>
          <td><button class="nut-xem" onclick="xemChiTiet('${don.maDon}')">Xem</button></td>
        `;
        bang.appendChild(dong);
      });
    }

    hienThiDanhSach();

    // ‚öôÔ∏è B∆Ø·ªöC 3: Hi·ªÉn th·ªã chi ti·∫øt ƒë∆°n h√†ng
    function xemChiTiet(maDon) {
      const don = danhSachDon.find(d => d.maDon === maDon);
      if (don) {
        lichSu.style.display = "none";
        chiTiet.style.display = "block";

        const thongTin = document.getElementById("thongTinDon");
        thongTin.innerHTML = `
          <p class="thongtin"><strong>M√£ ƒë∆°n h√†ng:</strong> ${don.maDon}</p>
          <p class="thongtin"><strong>Ng√†y mua:</strong> ${don.ngayMua}</p>
          <p class="thongtin"><strong>Tr·∫°ng th√°i:</strong> ${don.trangThai}</p>
          <p class="thongtin"><strong>T·ªïng ti·ªÅn:</strong> ${don.tongTien}</p>
        `;

        const bangSP = document.getElementById("danhSachSanPham");
        bangSP.innerHTML = "";

        (don.sanPham || []).forEach(sp => {
          const dong = document.createElement("tr");
          dong.innerHTML = `
            <td>${sp.tenSach}</td>
            <td>${sp.soLuong}</td>
            <td>${sp.gia}</td>
          `;
          bangSP.appendChild(dong);
        });
      }
    }

    // ‚öôÔ∏è B∆Ø·ªöC 4: Quay l·∫°i trang l·ªãch s·ª≠
    function quayLai() {
      chiTiet.style.display = "none";
      lichSu.style.display = "block";
    }
  </script>
</body>
</html>
